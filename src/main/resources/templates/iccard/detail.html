<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head th:include="head::head(${title})">
</head>
<script th:src="@{/graindepot-inout/js/IC.js}"></script>
<body>
<div th:replace="navbar::navbar"></div>
<div class="main-container" id="main-container">
    <div class="breadcrumbs" id="breadcrumbs">
        <ul class="breadcrumb">
            <li>
                <i class="icon-home home-icon"></i>
                首页
            </li>
            <li>
                <i class="icon-table home-icon"></i>
                ic卡资料
            </li>
        </ul>
    </div>
    <div style="margin-top: 4px;margin-bottom: 4px">
        <div class="col-sm-3">
            <div class="input-group">
                <span class="input-group-addon">IC卡内码号:</span>
                <input id="0_0" name="iccardnm" type="text"
                       class="form-control" readonly>
            </div>
        </div>
        <div class="col-sm-8">
            <div class="col-sm-4">
                <div class="input-group">
                    <span class="input-group-addon">读卡器型号:</span>
                    <select id="type" class="form-control">
                    </select>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="input-group">
                    <span class="input-group-addon">块序号:</span>
                    <input id="num" type="text" class="form-control"/>
                </div>
            </div>
            <div class="col-sm-4">
                <button class="btn btn-sm btn-success" onclick="readCard()">
                    <i class="icon-search align-top bigger-125"></i>
                    读取IC卡数据
                </button>
                <button class="btn btn-sm btn-success" onclick="test()">
                    <i class="icon-search align-top bigger-125"></i>
                    test
                </button>
            </div>
        </div>
    </div>


    <div class="table-responsive" style="width:100%">
        <OBJECT id=rd codeBase="comRD800.cab" WIDTH="10" HEIGHT="0"
                classid="clsid:638B238E-EB84-4933-B3C8-854B86140668">
        </OBJECT>
        <object classid="clsid:5EB842AE-5C49-4FD8-8CE9-77D4AF9FD4FF" id="IdrControl1" width="10" height="0" codebase="idr.cab">
        </object>
        <table id="myTable" style="width:80%;margin-top: 4px;" class="table table-striped table-bordered table-hover">
            <tr>
                <th class="center"></th>
                <th class="center">0</th>
                <th class="center">1</th>
                <th class="center">2</th>
            </tr>
            <tr>
                <td class="center">0</td>
                <td class="center"></td>
                <td class="center" id="0_1"></td>
                <td class="center" id="0_2"></td>
            </tr>
            <tr>
                <td class="center">1</td>
                <td class="center" id="1_0"></td>
                <td class="center" id="1_1"></td>
                <td class="center" id="1_2"></td>
            </tr>
            <tr>
                <td class="center">2</td>
                <td class="center" id="2_0"></td>
                <td class="center" id="2_1"></td>
                <td class="center" id="2_2"></td>
            </tr>
            <tr>
                <td class="center">3</td>
                <td class="center" id="3_0"></td>
                <td class="center" id="3_1"></td>
                <td class="center" id="3_2"></td>
            </tr>
            <tr>
                <td class="center">4</td>
                <td class="center" id="4_0"></td>
                <td class="center" id="4_1"></td>
                <td class="center" id="4_2"></td>
            </tr>
            <tr>
                <td class="center">5</td>
                <td class="center" id="5_0"></td>
                <td class="center" id="5_1"></td>
                <td class="center" id="5_2"></td>
            </tr>
            <tr>
                <td class="center">6</td>
                <td class="center" id="6_0"></td>
                <td class="center" id="6_1"></td>
                <td class="center" id="6_2"></td>
            </tr>
            <tr>
                <td class="center">7</td>
                <td class="center" id="7_0"></td>
                <td class="center" id="7_1"></td>
                <td class="center" id="7_2"></td>
            </tr>
            <tr>
                <td class="center">8</td>
                <td class="center" id="8_0"></td>
                <td class="center" id="8_1"></td>
                <td class="center" id="8_2"></td>
            </tr>
            <tr>
                <td class="center">9</td>
                <td class="center" id="9_0"></td>
                <td class="center" id="9_1"></td>
                <td class="center" id="9_2"></td>
            </tr>
            <tr>
                <td class="center">10</td>
                <td class="center" id="10_0"></td>
                <td class="center" id="10_1"></td>
                <td class="center" id="10_2"></td>
            </tr>
            <tr>
                <td class="center">11</td>
                <td class="center" id="11_0"></td>
                <td class="center" id="11_1"></td>
                <td class="center" id="11_2"></td>
            </tr>
            <tr>
                <td class="center">12</td>
                <td class="center" id="12_0"></td>
                <td class="center" id="12_1"></td>
                <td class="center" id="12_2"></td>
            </tr>
            <tr>
                <td class="center">13</td>
                <td class="center" id="13_0"></td>
                <td class="center" id="13_1"></td>
                <td class="center" id="13_2"></td>
            </tr>
            <tr>
                <td class="center">14</td>
                <td class="center" id="14_0"></td>
                <td class="center" id="14_1"></td>
                <td class="center" id="14_2"></td>
            </tr>
            <tr>
                <td class="center">15</td>
                <td class="center" id="15_0"></td>
                <td class="center" id="15_1"></td>
                <td class="center" id="15_2"></td>
            </tr>
        </table>

    </div>


    <a href="#" id="btn-scroll-up" class="btn-scroll-up btn btn-sm btn-inverse">
        <i class="icon-double-angle-up icon-only bigger-110"></i>
    </a>
</div>
</body>
</html>


<script type="text/javascript">
    var urlPrefix = "/graindepot-inout";
    //var urlPrefix = "";
    var theTable;
    $(document).ready(function () {
        initType();
    });

    function initType() {
        var data=[{value: 1, text: "精伦"},{value: 2, text: "d8"}];
        $("#type").bootstrapSelect({
            data:data,
            type: 'GET',
            valueField: 'value',
            textField: 'text'
        });
    }

    function readCard() {
        var type=$("#type").bootstrapSelect("getValue");
        if (!type){
            $.bootstrapBox.alert.init({message:"请选择读卡器型号"})
            return
        }
        var IC=new IcFactory(type).createIcObject();
        var result=IC.readCardAll();
        result.forEach(function (value) {
            if (value.index!='0_0'){
                $("#"+value.index).html(value.data)
            }
        });
        $("#0_0").val(IC.readCardNum())
    }
    function test() {
        var type=$("#type").bootstrapSelect("getValue");
        if (!type){
            $.bootstrapBox.alert.init({message:"请选择读卡器型号"})
            return
        }
        var IC=new IcFactory(type).createIcObject();
        var num=$("#num").val();
        var a=IC.readCard(num)
        alert(a)
        console.log(a)
    }


</script>
